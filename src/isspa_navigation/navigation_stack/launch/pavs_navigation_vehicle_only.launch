<launch>
    <!-- 
    小车端启动文件 - 只启动底盘、传感器和导航节点
    Vehicle-side launch file - Only start chassis, sensors, and navigation nodes
    YOLOv5检测在PC端执行
    YOLOv5 detection runs on PC
    -->
    
    <!-- 是否打开rviz || Whether to open rviz -->
    <arg name="use_rviz" default="false"/>
    <arg name="nav_use_rotvel" default="true"/>
    
    <!-- 地图名 || Map name -->
    <arg name="map" default="map"/>
    
    <!-- 摄像头参数 || Camera Parameters -->
    <arg name="enable_camera" default="true"/>  <!-- 启动摄像头，图像会发布到ROS话题 -->
    <arg name="camera_name" default="camera"/>  <!-- 摄像头名称 -->
    
    <!-- 摄像头启动 || Camera Launch -->
    <group if="$(arg enable_camera)">
        <!-- 启动Astra摄像头 -->
        <include file="$(find astra_camera)/launch/astra.launch">
            <arg name="camera_name" value="$(arg camera_name)"/>
            <arg name="enable_color" value="true"/>
            <arg name="enable_depth" value="false"/>
            <arg name="color_width" value="640"/>
            <arg name="color_height" value="480"/>
            <arg name="color_fps" value="30"/>
        </include>
    </group>
    
    <!-- MarkerArray node -->
    <node name='send_mark' pkg="navigation_stack" type="send_mark.py"/>
    
    <!-- 加载地图 || Load map -->
    <node name="map_server" pkg="map_server" type="map_server" args="$(find mapping_baselines)/maps/$(arg map).yaml"/>
    
    <!-- AMCL自适应蒙特卡洛定位 -->
    <include file="$(find navigation_stack)/launch/library/amcl.launch"/>
    
    <!-- 导航核心组件move_base -->
    <include file="$(find navigation_stack)/launch/library/move_base.launch">
        <arg name="nav_use_rotvel" value="$(arg nav_use_rotvel)"/>
    </include>
    
    <!-- 注意：红绿灯检测节点在PC端启动 -->
    <!-- Note: Traffic light detection nodes are started on PC -->
    
    <!-- RVIZ -->
    <include file="$(find navigation_stack)/launch/view/view_navigate.launch" if="$(arg use_rviz)"/>
</launch>

